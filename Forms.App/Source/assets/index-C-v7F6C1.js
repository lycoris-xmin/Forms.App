import{_ as ee}from"./table-header-operation.vue_vue_type_script_setup_true_lang-BX-iDe8o.js";import{_ as te,a as oe,b as ne,T as ae,u as se,c as le,d as re,e as ie,f as ue}from"./table-search-filter-oeJAv4cw.js";import{d as M,D as R,E as Y,c as q,o as $,w as n,f as e,e as C,B as I,a as z,r as de,F as pe,g as H,q as ce,b as me,h as t,a8 as U,a9 as L}from"./index-C4fDvJn1.js";import{u as fe,A as E}from"./app.permissions-eEP3QY97.js";import{u as j,F as W,_ as G,I as K,a as _e}from"./form-C4lsPmD3.js";import{_ as he}from"./index-Bgjt1Cd5.js";import{S as ge}from"./index-DjcmxpZa.js";import{f as ve,a as be,b as V,c as ye}from"./shop-B6rmWROD.js";import{_ as we}from"./index-B0OEq9ON.js";import{C as De}from"./index-CfF1NG6B.js";import{E as xe}from"./EditOutlined-CFKuvutP.js";import{D as Ae}from"./DeleteOutlined-vV5-dJ7B.js";import"./index-BSgdO99v.js";import"./EyeOutlined-DMOywdMm.js";import"./index-tKWHzGWZ.js";import"./LeftOutlined-byKmxFgc.js";import"./responsiveObserve-k0SNxmCv.js";import"./debounce-C-eHgR1J.js";import"./isSymbol-7IJmde0n.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Se={class:"flex-1"},ke={class:"w-full flex-y-center justify-end gap-12px"},Te=M({name:"TaobaoProductListSearch",__name:"search-filter",props:R({userInfo:{},shopNameEnum:{}},{model:{required:!0},modelModifiers:{}}),emits:R(["reset","search"],["update:model"]),setup(y,{emit:g}){const{formRef:d,validate:w,resetFields:D}=j(),f=Y(y,"model"),r=g;async function u(){await D(),r("reset")}async function x(){await w(),r("search")}return(A,i)=>{const l=K,p=G,v=he,_=oe,h=I,S=ne,c=te,s=W;return $(),q(ae,null,{default:n(()=>[e(s,{ref_key:"formRef",ref:d,class:"search-filter",model:f.value,"label-col":{span:5,md:7}},{default:n(()=>[e(c,{gutter:[16,16],wrap:""},{default:n(()=>[e(v,{span:24,md:12,lg:6},{default:n(()=>[e(p,{label:"店铺名称",name:"shopName",class:"m-0"},{default:n(()=>[e(l,{value:f.value.shopName,"onUpdate:value":i[0]||(i[0]=m=>f.value.shopName=m),autocomplete:"off",placeholder:"支持模糊查询"},null,8,["value"])]),_:1})]),_:1}),C("div",Se,[e(p,{class:"m-0"},{default:n(()=>[C("div",ke,[e(h,{onClick:u},{icon:n(()=>[e(_,{class:"align-sub text-icon"})]),default:n(()=>[i[1]||(i[1]=C("span",{class:"ml-8px"},"重置",-1))]),_:1}),e(h,{type:"primary",ghost:"",onClick:x},{icon:n(()=>[e(S,{class:"align-sub text-icon"})]),default:n(()=>[i[2]||(i[2]=C("span",{class:"ml-8px"},"搜索",-1))]),_:1})])]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})}}}),Fe=M({name:"DyShopOperateDrawer",__name:"operate-drawer",props:R({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:R(["submitted"],["update:visible"]),setup(y,{emit:g}){const{formRef:d,validate:w,resetFields:D}=j(),{defaultRequiredRule:f}=_e(),r=Y(y,"visible"),u=y,x=g,A=z(()=>({add:"新增店铺",edit:"编辑店铺"})[u.operateType]),i=z(()=>u.operateType==="edit"),l=de(v()),p={shopName:f};pe(r,()=>{r.value&&(_(),D())});function v(){return{id:"",shopName:"",loading:!1}}function _(){l.value=v(),i.value&&u.rowData&&Object.assign(l.value,u.rowData)}function h(){r.value=!1}async function S(){var c;await w(),l.value.loading=!0;try{const{data:s,error:m}=i.value?await ve({...l.value}):await be(l.value.shopName);!m&&s&&s.code===0&&((c=window.$message)==null||c.success("保存成功"),h(),x("submitted"))}finally{l.value.loading=!1}}return(c,s)=>{const m=K,N=G,B=W,F=I,O=ge,P=we;return $(),q(P,{open:r.value,"onUpdate:open":s[1]||(s[1]=k=>r.value=k),title:A.value,width:550},{footer:n(()=>[e(O,{size:16},{default:n(()=>[e(F,{onClick:h},{default:n(()=>s[2]||(s[2]=[H("取消")])),_:1}),e(F,{type:"primary",loading:l.value.loading,onClick:S},{default:n(()=>s[3]||(s[3]=[H("保存")])),_:1},8,["loading"])]),_:1})]),default:n(()=>[e(B,{ref_key:"formRef",ref:d,layout:"vertical",model:l.value,rules:p},{default:n(()=>[e(N,{label:"店铺名称",name:"shopName"},{default:n(()=>[e(m,{value:l.value.shopName,"onUpdate:value":s[0]||(s[0]=k=>l.value.shopName=k),placeholder:"请输入店铺名称",maxlength:100},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),Ce={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Je=M({name:"douyin_shop",__name:"index",setup(y){const g=ce(),d=fe(),{tableWrapperRef:w,scrollConfig:D}=se(),{columns:f,columnChecks:r,data:u,getData:x,getDataByPage:A,loading:i,mobilePagination:l,searchParams:p,resetSearchParams:v}=le({apiFn:o=>ye({...o}),apiParams:{pageIndex:1,pageSize:10},columns:k}),{drawerVisible:_,operateType:h,editingData:S,handleAdd:c,handleEdit:s,checkedRowKeys:m,rowSelection:N,onBatchDeleted:B,onDeleted:F}=re(u,x);async function O(){const o=m.value;if(o&&o.length){const{data:a,error:T}=await V(o);!T&&a&&a.code===0&&B()}}async function P(o){const{data:a,error:T}=await V([o]);!T&&a&&a.code===0&&F()}function k(){const o=[{key:"shopName",dataIndex:"shopName",title:"店铺名称",width:300},{key:"count",dataIndex:"count",title:"商品数量",width:150}];return g.userInfo.isTenant||o.push({key:"tenantUser",dataIndex:"tenantUser",title:"所属商户",width:200}),o.push({key:"createTime",dataIndex:"createTime",title:"添加时间",align:"center",width:200}),o.push({key:"operate",title:"操作",align:"center",width:130,customRender:({record:a})=>e("div",{class:"flex-center gap-4px"},[J(a),Q(a)])}),o}function J(o){if(d.hasOne(E.DY.Shop.UPDATE)){if(o.roleId===1e3)return""}else return"";return e(L,{placement:"top",title:"编辑"},{default:()=>[e(I,{size:"small",type:"link",onClick:()=>s(o.id)},{default:()=>[e(xe,null,null)]})]})}function Q(o){if(d.hasOne(E.DY.Shop.DELETE)){if(o.roleId===1e3)return""}else return"";return e(ue,{title:"确认删除吗？",onConfirm:()=>P(o.id)},{default:()=>[e(L,{placement:"top",title:"删除"},{default:()=>[e(I,{danger:!0,size:"small",type:"link"},{default:()=>[e(Ae,null,null)]})]})]})}return(o,a)=>{const T=ee,X=ie,Z=De;return $(),me("div",Ce,[e(Te,{model:t(p),"onUpdate:model":a[0]||(a[0]=b=>U(p)?p.value=b:null),"user-info":t(g).userInfo,onReset:t(v),onSearch:a[1]||(a[1]=b=>t(A)(1))},null,8,["model","user-info","onReset"]),e(Z,{title:"店铺列表",bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:n(()=>[e(T,{columns:t(r),"onUpdate:columns":a[2]||(a[2]=b=>U(r)?r.value=b:null),"disabled-delete":t(m).length===0,loading:t(i),"add-btn":t(d).hasOne(t(E).DY.Shop.CREATE),"delete-btn":t(d).hasOne(t(E).DY.Shop.DELETE),onAdd:t(c),onDelete:O},null,8,["columns","disabled-delete","loading","add-btn","delete-btn","onAdd"])]),default:n(()=>[e(X,{ref_key:"tableWrapperRef",ref:w,columns:t(f),"data-source":t(u),size:"small","row-selection":t(N),scroll:t(D),loading:t(i),"row-key":"id",pagination:t(l),class:"h-full"},null,8,["columns","data-source","row-selection","scroll","loading","pagination"]),e(Fe,{visible:t(_),"onUpdate:visible":a[3]||(a[3]=b=>U(_)?_.value=b:null),"operate-type":t(h),"row-data":t(S),onSubmitted:t(A)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{Je as default};
