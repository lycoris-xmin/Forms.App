import{f as b,O as w,d as y,D as x,E as B,r as S,c as m,o as f,w as h,b as _,H as z,P as L,g as j,t as P}from"./index-CZVtSjPQ.js";import{S as U,g as $}from"./table-search-filter-DgS7ifzw.js";import{b as k}from"./enums-XBoEbamp.js";import{i as F}from"./empty-DqSXm535.js";var M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M740 161c-61.8 0-112 50.2-112 112 0 50.1 33.1 92.6 78.5 106.9v95.9L320 602.4V318.1c44.2-15 76-56.9 76-106.1 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 49.2 31.8 91 76 106.1V706c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-27.8l423.5-138.7a50.52 50.52 0 0034.9-48.2V378.2c42.9-15.8 73.6-57 73.6-105.2 0-61.8-50.2-112-112-112zm-504 51a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm96 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm408-491a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"branches",theme:"outlined"};function p(t){for(var a=1;a<arguments.length;a++){var e=arguments[a]!=null?Object(arguments[a]):{},n=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),n.forEach(function(l){R(t,l,e[l])})}return t}function R(t,a,e){return a in t?Object.defineProperty(t,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[a]=e,t}var v=function(a,e){var n=p({},a,e.attrs);return b(w,p({},n,{icon:M}),null)};v.displayName="BranchesOutlined";v.inheritAttrs=!1;const A=y({__name:"index",props:x({allowClear:{type:Boolean,default:!0},placeholder:{default:"- 全部 -"}},{value:{default:"",required:!0},valueModifiers:{}}),emits:["update:value"],setup(t){const a=B(t,"value"),e=S([]),n=t,l=async r=>{if(r){const{data:o,error:i}=await k(r);!i&&o&&o.code===0&&(e.value=o.data.list)}else e.value=[]};return(r,o)=>{const i=$,u=U;return f(),m(u,{value:a.value,"onUpdate:value":o[0]||(o[0]=s=>a.value=s),placeholder:n.placeholder,"show-search":"","filter-option":!1,"allow-clear":n.allowClear,onSearch:l},{default:h(()=>[(f(!0),_(z,null,L(e.value,s=>(f(),m(i,{key:s.value,value:s.value},{default:h(()=>[j(P(`${s.text} (${s.value})`),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder","allow-clear"])}}});function T(t){return new Promise(a=>{const e=document.createElement("canvas");e.width=t.videoWidth,e.height=t.videoHeight;const n=e.getContext("2d");n?(n.drawImage(t,0,0,e.width,e.height),requestAnimationFrame(()=>{a(e.toDataURL("image/jpeg",.8))})):a("")})}async function I(t,a){if(!t.type.includes("video"))throw new Error("请上传一个视频文件");const e=URL.createObjectURL(t);return new Promise((n,l)=>{const r=document.createElement("video");r.preload="metadata",r.src=e,r.crossOrigin="anonymous",r.muted=!0,r.onloadedmetadata=()=>{const o=r.duration,i=`${Math.floor(o/60)} 分 ${Math.floor(o%60)} 秒`;let u=0;o>1&&(u=o/2),r.currentTime=u,r.onseeked=async()=>{let s="";try{s=await T(r)}catch{s=F}const c=t.size;let d="0";c<1024*1024?d=`${(c/1024).toFixed(2)} KB`:c<1024*1024*1024?d=`${(c/1024/1024).toFixed(2)} MB`:d=`${(c/1024/1024/1024).toFixed(2)} GB`;const g={file:t,size:c,type:t.type,src:e,duration:o,durationText:i,sizeText:d,thumbnail:s,isFileSizeOver(O){return this.size!==null&&this.size>O*1024*1024},dispose(){this.src&&URL.revokeObjectURL(this.src)}};n(g)}},r.onerror=()=>{URL.revokeObjectURL(e),l(new Error("视频加载失败"))}})}export{v as B,A as _,I as v};
