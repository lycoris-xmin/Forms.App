import{_ as ee}from"./table-header-operation.vue_vue_type_script_setup_true_lang-C7seoTxq.js";import{_ as te,a as oe,b as ae,T as ne,u as le,c as se,d as re,e as ie,f as ue}from"./table-search-filter-DgS7ifzw.js";import{d as z,D as R,E as j,c as $,o as N,w as a,f as e,z as de,e as F,B,a as H,r as pe,F as me,g as M,q as ce,b as fe,h as t,a8 as P,a9 as V}from"./index-CZVtSjPQ.js";import{u as _e,A as E}from"./app.permissions-B_pV7apU.js";import{u as G,F as W,_ as K,I as J,a as he}from"./form-ZxLsforZ.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-pVOlQRHe.js";import{_ as ge}from"./index-DOEbmRvB.js";import{S as be}from"./index-BWb-9rJv.js";import{U as we,C as ye,D as q,G as Ae}from"./shop-3HyB7hgQ.js";import{_ as xe}from"./index-BVBn8Dpq.js";import{C as Ie}from"./index-ClUX1lZP.js";import{E as Se}from"./EditOutlined-S8fzz_Is.js";import{D as ke}from"./DeleteOutlined-CShsKEiR.js";import"./index-CQCXu6T9.js";import"./EyeOutlined-B3DWie8W.js";import"./index-Ds_LW8Zf.js";import"./LeftOutlined-Cj56myxb.js";import"./responsiveObserve-CdtC9r70.js";import"./debounce-BsWDECm-.js";import"./isSymbol-DgABtkrl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./enums-XBoEbamp.js";const De={class:"flex-1"},Te={class:"w-full flex-y-center justify-end gap-12px"},Ce=z({name:"ALISHopListSearch",__name:"search-filter",props:R({userInfo:{},shopNameEnum:{}},{model:{required:!0},modelModifiers:{}}),emits:R(["reset","search"],["update:model"]),setup(v,{emit:g}){const{formRef:d,validate:I,resetFields:S}=G(),u=j(v,"model"),r=v,i=g;async function k(){await S(),i("reset")}async function b(){await I(),i("search")}return(w,o)=>{const _=J,p=K,m=ge,y=oe,A=B,c=ae,s=te,f=W;return N(),$(ne,null,{default:a(()=>[e(f,{ref_key:"formRef",ref:d,class:"search-filter",model:u.value,"label-col":{span:5,md:7}},{default:a(()=>[e(s,{gutter:[16,16],wrap:""},{default:a(()=>[e(m,{span:24,md:12,lg:6},{default:a(()=>[e(p,{label:"店铺名称",name:"shopName",class:"m-0"},{default:a(()=>[e(_,{value:u.value.shopName,"onUpdate:value":o[0]||(o[0]=h=>u.value.shopName=h),autocomplete:"off",placeholder:"支持模糊查询"},null,8,["value"])]),_:1})]),_:1}),r.userInfo.isTenant?de("",!0):(N(),$(m,{key:0,span:24,md:12,lg:6},{default:a(()=>[e(p,{label:"所属商户",name:"tenantId",class:"m-0"},{default:a(()=>[e(ve,{value:u.value.tenantId,"onUpdate:value":o[1]||(o[1]=h=>u.value.tenantId=h),placeholder:"- 全部 -"},null,8,["value"])]),_:1})]),_:1})),F("div",De,[e(p,{class:"m-0"},{default:a(()=>[F("div",Te,[e(A,{onClick:k},{icon:a(()=>[e(y,{class:"align-sub text-icon"})]),default:a(()=>[o[2]||(o[2]=F("span",{class:"ml-8px"},"重置",-1))]),_:1}),e(A,{type:"primary",ghost:"",onClick:b},{icon:a(()=>[e(c,{class:"align-sub text-icon"})]),default:a(()=>[o[3]||(o[3]=F("span",{class:"ml-8px"},"搜索",-1))]),_:1})])]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})}}}),Fe=z({name:"ALIShopOperateDrawer",__name:"operate-drawer",props:R({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:R(["submitted"],["update:visible"]),setup(v,{emit:g}){const{formRef:d,validate:I,resetFields:S}=G(),{defaultRequiredRule:u}=he(),r=j(v,"visible"),i=v,k=g,b=H(()=>({add:"新增店铺",edit:"编辑店铺"})[i.operateType]),w=H(()=>i.operateType==="edit"),o=pe(p()),_={shopName:u};me(r,()=>{r.value&&(m(),S())});function p(){return{id:"",shopName:"",loading:!1}}function m(){o.value=p(),w.value&&i.rowData&&Object.assign(o.value,i.rowData)}function y(){r.value=!1}async function A(){var c;await I(),o.value.loading=!0;try{const{data:s,error:f}=w.value?await we({...o.value}):await ye(o.value.shopName);!f&&s&&s.code===0&&((c=window.$message)==null||c.success("保存成功"),y(),k("submitted"))}finally{o.value.loading=!1}}return(c,s)=>{const f=J,h=K,U=W,C=B,L=be,O=xe;return N(),$(O,{open:r.value,"onUpdate:open":s[1]||(s[1]=D=>r.value=D),title:b.value,width:550},{footer:a(()=>[e(L,{size:16},{default:a(()=>[e(C,{onClick:y},{default:a(()=>s[2]||(s[2]=[M("取消")])),_:1}),e(C,{type:"primary",loading:o.value.loading,onClick:A},{default:a(()=>s[3]||(s[3]=[M("保存")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[e(U,{ref_key:"formRef",ref:d,layout:"vertical",model:o.value,rules:_},{default:a(()=>[e(h,{label:"店铺名称",name:"shopName"},{default:a(()=>[e(f,{value:o.value.shopName,"onUpdate:value":s[0]||(s[0]=D=>o.value.shopName=D),placeholder:"请输入店铺名称",maxlength:100},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),Ee={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},et=z({name:"alibaba_shop",__name:"index",setup(v){const g=ce(),d=_e(),{tableWrapperRef:I,scrollConfig:S}=le(),{columns:u,columnChecks:r,data:i,getData:k,getDataByPage:b,loading:w,mobilePagination:o,searchParams:_,resetSearchParams:p}=se({apiFn:n=>Ae({...n}),apiParams:{pageIndex:1,pageSize:10},columns:D}),{drawerVisible:m,operateType:y,editingData:A,handleAdd:c,handleEdit:s,checkedRowKeys:f,rowSelection:h,onBatchDeleted:U,onDeleted:C}=re(i,k);async function L(){const n=f.value;if(n&&n.length){const{data:l,error:T}=await q(n);!T&&l&&l.code===0&&U()}}async function O(n){const{data:l,error:T}=await q([n]);!T&&l&&l.code===0&&C()}function D(){const n=[{key:"shopName",dataIndex:"shopName",title:"店铺名称",width:300},{key:"count",dataIndex:"count",title:"商品数量",width:150}];return g.userInfo.isTenant||n.push({key:"tenantUser",dataIndex:"tenantUser",title:"所属商户",width:200}),n.push({key:"createTime",dataIndex:"createTime",title:"添加时间",align:"center",width:200}),n.push({key:"operate",title:"操作",align:"center",width:130,customRender:({record:l})=>e("div",{class:"flex-center gap-4px"},[Q(l),X(l)])}),n}function Q(n){if(d.hasOne(E.Ali1688.Shop.UPDATE)){if(n.roleId===1e3)return""}else return"";return e(V,{placement:"top",title:"编辑"},{default:()=>[e(B,{size:"small",type:"link",onClick:()=>s(n.id)},{default:()=>[e(Se,null,null)]})]})}function X(n){if(d.hasOne(E.Ali1688.Shop.DELETE)){if(n.roleId===1e3)return""}else return"";return e(ue,{title:"确认删除吗？",onConfirm:()=>O(n.id)},{default:()=>[e(V,{placement:"top",title:"删除"},{default:()=>[e(B,{danger:!0,size:"small",type:"link"},{default:()=>[e(ke,null,null)]})]})]})}return(n,l)=>{const T=ee,Y=ie,Z=Ie;return N(),fe("div",Ee,[e(Ce,{model:t(_),"onUpdate:model":l[0]||(l[0]=x=>P(_)?_.value=x:null),"user-info":t(g).userInfo,onReset:t(p),onSearch:l[1]||(l[1]=x=>t(b)(1))},null,8,["model","user-info","onReset"]),e(Z,{title:"店铺列表",bordered:!1,"body-style":{flex:1,overflow:"hidden"},class:"flex-col-stretch sm:flex-1-hidden card-wrapper"},{extra:a(()=>[e(T,{columns:t(r),"onUpdate:columns":l[2]||(l[2]=x=>P(r)?r.value=x:null),"disabled-delete":t(f).length===0,loading:t(w),"add-btn":t(d).hasOne(t(E).Ali1688.Shop.CREATE),"delete-btn":t(d).hasOne(t(E).Ali1688.Shop.DELETE),onAdd:t(c),onDelete:L},null,8,["columns","disabled-delete","loading","add-btn","delete-btn","onAdd"])]),default:a(()=>[e(Y,{ref_key:"tableWrapperRef",ref:I,columns:t(u),"data-source":t(i),size:"small","row-selection":t(h),scroll:t(S),loading:t(w),"row-key":"id",pagination:t(o),class:"h-full"},null,8,["columns","data-source","row-selection","scroll","loading","pagination"]),e(Fe,{visible:t(m),"onUpdate:visible":l[3]||(l[3]=x=>P(m)?m.value=x:null),"operate-type":t(y),"row-data":t(A),onSubmitted:t(b)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}});export{et as default};
